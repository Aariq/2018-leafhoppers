---
title: "Compound names and descriptors"
author: "Eric R. Scott"
date: "Date Initiated"
output: 
  html_notebook: 
    highlight: kate
    theme: yeti
    toc: yes
    toc_float: yes
    number_sections: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

*Last compiled: `r Sys.Date()`*

```{r packages, include=FALSE}
library(tidyverse)
library(here)
library(webchem)
```

# Purpose

To get better names, literature RIs, and flavor descriptors for compounds used in both years combined

# Load Data

```{r data, echo=TRUE}
gc2017 <- read_rds(here("data", "cleaned", "2017_gcms_tidy.rds"))
gc2018 <- read_rds(here("data", "cleaned", "2018_gcms_tidy.rds"))
```

For now, just get CAS and Compound

```{r}
compounds2017 <- gc2017 %>% group_by(Compound, CAS) %>% count() %>% select(-n)
compounds2018 <- gc2018 %>% group_by(Compound, CAS) %>% count() %>% select(-n)
df <- full_join(compounds2017, compounds2018)
```
# Get better names
pc_synonyms doesn't take CAS numbers directly.
```{r}
df2 <-
  df %>% 
  mutate(inchikey = ifelse(is.na(CAS), NA, cts_convert(CAS, from = "CAS", to = "InChIKey", choices = 1)))

df3 <-
  df2 %>% 
  mutate(pretty_name = ifelse(is.na(inchikey), NA, pc_synonyms(inchikey, from = "inchikey", choices = 10)))
View(df3)
write_excel_csv(df3, here("data", "raw", "compound CAS and names.csv"))
```

You should compare this with names you used from the BACE paper before doing a ton of editing by hand.

TODO:

- get pretty names for all compounds
- make a column for latex formatted version